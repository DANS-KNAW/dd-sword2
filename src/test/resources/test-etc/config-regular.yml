server:
  applicationContextPath: /
  adminContextPath: /
  applicationConnectors:
    - type: http
      # Replace with port number unique for this service
      port: 0
  adminConnectors:
    - type: http
      # Replace with port number unique for this service
      port: 0
  requestLog:
    appenders: [ ]

authorization:
  passwordDelegate:
    url: http://localhost:20000/
    forwardHeaders:
      - authorization
      - x-dataverse-key
  users:
    - name: 'user001'
      passwordHash: '$2a$10$yvmSYczU7z4KL6qmRCTgTeSvo7uurwPUbB9s/mTKzJrYM/sQKgF.y' # user001
      filepathMapping: true
      collections:
        - collection1

sword2:
  baseUrl: 'http://localhost:20320/'
  emailAddress: 'test@test.com'
  collections:
    - name: 'collection1'
      path: '1'
      uploads: ${TEST_DIR}/1/uploads
      deposits: ${TEST_DIR}/1/deposits
      depositTrackingPath:
        - ${TEST_DIR}/1/outbox/1
        - ${TEST_DIR}/1/outbox/2
        - ${TEST_DIR}/1/outbox/3
      autoClean:
        - INVALID
      diskSpaceMargin: 2G
    - name: 'collection2'
      path: '2'
      uploads: ${TEST_DIR}/2/uploads
      deposits: ${TEST_DIR}/2/deposits
      depositTrackingPath:
        - ${TEST_DIR}/2/outbox/1
        - ${TEST_DIR}/2/outbox/2
        - ${TEST_DIR}/2/outbox/3
      autoClean:
        - INVALID
      diskSpaceMargin: 2G
  rescheduleDelay: PT30S
  finalizingQueue:
    nameFormat: "finalization-worker-%d"
    maxQueueSize: 5000
    # Number of threads will be increased when maxQueueSize is exceeded.
    minThreads: 2
    # No more than maxThreads will be created though
    maxThreads: 5
    # Threads will die after 60 seconds of idleness
    keepAliveTime: 60 seconds
  rescheduleQueue:
    nameFormat: "finalization-worker-%d"
    maxQueueSize: 5000
    # Number of threads will be increased when maxQueueSize is exceeded.
    minThreads: 2
    # No more than maxThreads will be created though
    maxThreads: 5
    # Threads will die after 60 seconds of idleness
    keepAliveTime: 60 seconds

#
# See https://www.dropwizard.io/en/latest/manual/configuration.html#logging
#
logging:
  level: off

health:
  delayedShutdownHandlerEnabled: false
  initialOverallState: false
  healthChecks:
    - critical: true
      name: DiskSpace
    - critical: true
      name: UploadDepositIsOnSameFileSystem
    - critical: true
      name: FileSystemPermissions
    - critical: true
      name: FinalizerQueue
    - critical: true
      name: FinalizingExecutor
    - critical: true
      name: RescheduleExecutor
